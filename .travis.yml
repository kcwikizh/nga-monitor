language: python
python:
  - 3.7
install:
  - pip install -r requirements.txt
branches:
  only:
    - master
before_script:
script:
  - python main.py
before_deploy:
  - cp README.md dist/
  - if [ $CNAME ]; then
    echo $CNAME > dist/CNAME;
    fi
deploy:
  provider: pages
  name: kcwikizh
  email: dev@kcwiki.moe
  github_token: $GITHUB_TOKEN
  skip-cleanup: true
  keep-history: true
  local-dir: build
  on:
    branch: master
    condition: $GITHUB_TOKEN
